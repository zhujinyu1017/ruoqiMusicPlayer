{
  "_from": "node-pre-gyp@^0.6.36",
  "_id": "node-pre-gyp@0.6.36",
  "_inBundle": false,
  "_integrity": "sha1-22BBEst04NR3VU6bUFsXq936t4Y=",
  "_location": "/fsevents/node-pre-gyp",
  "_phantomChildren": {},
  "_requested": {
    "escapedName": "node-pre-gyp",
    "fetchSpec": "^0.6.36",
    "name": "node-pre-gyp",
    "raw": "node-pre-gyp@^0.6.36",
    "rawSpec": "^0.6.36",
    "registry": true,
    "saveSpec": null,
    "type": "range"
  },
  "_requiredBy": [
    "#USER",
    "/fsevents"
  ],
  "_resolved": "https://registry.npmjs.org/node-pre-gyp/-/node-pre-gyp-0.6.36.tgz",
  "_shasum": "db604112cb74e0d477554e9b505b17abddfab786",
  "_shrinkwrap": null,
  "_spec": "node-pre-gyp@^0.6.36",
  "_where": "/Users/eshanker/Code/fsevents",
  "author": {
    "email": "dane@mapbox.com",
    "name": "Dane Springmeyer"
  },
  "bin": {
    "node-pre-gyp": "./bin/node-pre-gyp"
  },
  "bugs": {
    "url": "https://github.com/mapbox/node-pre-gyp/issues"
  },
  "bundleDependencies": false,
  "dependencies": {
    "mkdirp": "^0.5.1",
    "nopt": "^4.0.1",
    "npmlog": "^4.0.2",
    "rc": "^1.1.7",
    "request": "^2.81.0",
    "rimraf": "^2.6.1",
    "semver": "^5.3.0",
    "tar": "^2.2.1",
    "tar-pack": "^3.4.0"
  },
  "deprecated": false,
  "description": "Node.js native addon binary install tool",
  "devDependencies": {
    "aws-sdk": "^2.28.0",
    "jshint": "^2.9.4",
    "mocha": "^3.2.0",
    "retire": "^1.2.12"
  },
  "homepage": "https://github.com/mapbox/node-pre-gyp#readme",
  "jshintConfig": {
    "globalstrict": true,
    "mocha": true,
    "noarg": true,
    "node": true,
    "undef": true,
    "unused": true
  },
  "keywords": [
    "addon",
    "binary",
    "bindings",
    "c",
    "c++",
    "module",
    "native"
  ],
  "license": "BSD-3-Clause",
  "main": "./lib/node-pre-gyp.js",
  "name": "node-pre-gyp",
  "optionalDependencies": {},
  "readme": "# node-pre-gyp\r\n\r\n#### node-pre-gyp makes it easy to publish and install Node.js C++ addons from binaries\r\n\r\n[![NPM](https://nodei.co/npm/node-pre-gyp.png?downloads=true&downloadRank=true)](https://nodei.co/npm/node-pre-gyp/)\r\n\r\n[![Build Status](https://api.travis-ci.org/mapbox/node-pre-gyp.svg)](https://travis-ci.org/mapbox/node-pre-gyp)\r\n[![Build status](https://ci.appveyor.com/api/projects/status/3nxewb425y83c0gv)](https://ci.appveyor.com/project/Mapbox/node-pre-gyp)\r\n[![Dependencies](https://david-dm.org/mapbox/node-pre-gyp.svg)](https://david-dm.org/mapbox/node-pre-gyp)\r\n\r\n`node-pre-gyp` stands between [npm](https://github.com/npm/npm) and [node-gyp](https://github.com/Tootallnate/node-gyp) and offers a cross-platform method of binary deployment.\r\n\r\n### Features\r\n\r\n - A command line tool called `node-pre-gyp` that can install your package's C++ module from a binary.\r\n - A variety of developer targeted commands for packaging, testing, and publishing binaries.\r\n - A JavaScript module that can dynamically require your installed binary: `require('node-pre-gyp').find`\r\n\r\nFor a hello world example of a module packaged with `node-pre-gyp` see <https://github.com/springmeyer/node-addon-example> and [the wiki ](https://github.com/mapbox/node-pre-gyp/wiki/Modules-using-node-pre-gyp) for real world examples.\r\n\r\n## Credits\r\n\r\n - The module is modeled after [node-gyp](https://github.com/Tootallnate/node-gyp) by [@Tootallnate](https://github.com/Tootallnate)\r\n - Motivation for initial development came from [@ErisDS](https://github.com/ErisDS) and the [Ghost Project](https://github.com/TryGhost/Ghost).\r\n - Development is sponsored by [Mapbox](https://www.mapbox.com/)\r\n\r\n## FAQ\r\n\r\nSee the [Frequently Ask Questions](https://github.com/mapbox/node-pre-gyp/wiki/FAQ).\r\n\r\n## Depends\r\n\r\n - Node.js >= node v0.10.x\r\n\r\n## Install\r\n\r\n`node-pre-gyp` is designed to be installed as a local dependency of your Node.js C++ addon and accessed like:\r\n\r\n    ./node_modules/.bin/node-pre-gyp --help\r\n\r\nBut you can also install it globally:\r\n\r\n    npm install node-pre-gyp -g\r\n\r\n## Usage\r\n\r\n### Commands\r\n\r\nView all possible commands:\r\n\r\n    node-pre-gyp --help\r\n\r\n- clean - Remove the entire folder containing the compiled .node module\r\n- install - Install pre-built binary for module\r\n- reinstall - Run \"clean\" and \"install\" at once\r\n- build - Compile the module by dispatching to node-gyp or nw-gyp\r\n- rebuild - Run \"clean\" and \"build\" at once\r\n- package - Pack binary into tarball\r\n- testpackage - Test that the staged package is valid\r\n- publish - Publish pre-built binary\r\n- unpublish - Unpublish pre-built binary\r\n- info - Fetch info on published binaries\r\n\r\nYou can also chain commands:\r\n\r\n    node-pre-gyp clean build unpublish publish info\r\n\r\n### Options\r\n\r\nOptions include:\r\n\r\n - `-C/--directory`: run the command in this directory\r\n - `--build-from-source`: build from source instead of using pre-built binary\r\n - `--update-binary`: reinstall by replacing previously installed local binary with remote binary\r\n - `--runtime=node-webkit`: customize the runtime: `node`, `electron` and `node-webkit` are the valid options\r\n - `--fallback-to-build`: fallback to building from source if pre-built binary is not available\r\n - `--target=0.10.25`: Pass the target node or node-webkit version to compile against\r\n - `--target_arch=ia32`: Pass the target arch and override the host `arch`. Valid values are 'ia32','x64', or `arm`.\r\n - `--target_platform=win32`: Pass the target platform and override the host `platform`. Valid values are `linux`, `darwin`, `win32`, `sunos`, `freebsd`, `openbsd`, and `aix`.\r\n\r\nBoth `--build-from-source` and `--fallback-to-build` can be passed alone or they can provide values. You can pass `--fallback-to-build=false` to override the option as declared in package.json. In addition to being able to pass `--build-from-source` you can also pass `--build-from-source=myapp` where `myapp` is the name of your module.\r\n\r\nFor example: `npm install --build-from-source=myapp`. This is useful if:\r\n\r\n - `myapp` is referenced in the package.json of a larger app and therefore `myapp` is being installed as a dependent with `npm install`.\r\n - The larger app also depends on other modules installed with `node-pre-gyp`\r\n - You only want to trigger a source compile for `myapp` and the other modules.\r\n\r\n### Configuring\r\n\r\nThis is a guide to configuring your module to use node-pre-gyp.\r\n\r\n#### 1) Add new entries to your `package.json`\r\n\r\n - Add `node-pre-gyp` to `dependencies`\r\n - Add `aws-sdk` as a `devDependency`\r\n - Add a custom `install` script\r\n - Declare a `binary` object\r\n\r\nThis looks like:\r\n\r\n```js\r\n    \"dependencies\"  : {\r\n      \"node-pre-gyp\": \"0.6.x\"\r\n    },\r\n    \"devDependencies\": {\r\n      \"aws-sdk\": \"2.x\"\r\n    }\r\n    \"bundledDependencies\":[\"node-pre-gyp\"],\r\n    \"scripts\": {\r\n        \"install\": \"node-pre-gyp install --fallback-to-build\"\r\n    },\r\n    \"binary\": {\r\n        \"module_name\": \"your_module\",\r\n        \"module_path\": \"./lib/binding/\",\r\n        \"host\": \"https://your_module.s3-us-west-1.amazonaws.com\"\r\n    }\r\n```\r\n\r\nFor a full example see [node-addon-examples's package.json](https://github.com/springmeyer/node-addon-example/blob/master/package.json).\r\n\r\nLet's break this down:\r\n\r\n - Dependencies need to list `node-pre-gyp`\r\n - Your devDependencies should list `aws-sdk` so that you can run `node-pre-gyp publish` locally or a CI system. We recommend using `devDependencies` only since `aws-sdk` is large and not needed for `node-pre-gyp install` since it only uses http to fetch binaries\r\n - You should add `\"bundledDependencies\":[\"node-pre-gyp\"]`. This ensures that when you publish your module that the correct version of node-pre-gyp will be included in the `node_modules` folder during publishing. Then when uses install your module `node-pre-gyp` will already be present. Without this your module will not be safely installable for downstream applications that have a depedency on node-pre-gyp in the npm tree (without bundling npm deduping might break the install when node-pre-gyp is moved in flight)\r\n - Your `scripts` section should optionally add `\"prepublish\": \"npm ls\"` to ensure the right node-pre-gyp version is bundled before publishing your module. If node-pre-gyp is missing or an old version is present then this will catch that error before you publish a broken package.\r\n - Your `scripts` section should override the `install` target with `\"install\": \"node-pre-gyp install --fallback-to-build\"`. This allows node-pre-gyp to be used instead of the default npm behavior of always source compiling with `node-gyp` directly.\r\n - Your package.json should contain a `binary` section describing key properties you provide to allow node-pre-gyp to package optimally. They are detailed below.\r\n\r\nNote: in the past we recommended using `\"preinstall\": \"npm install node-pre-gyp\"` as an alternative method to avoid needing to bundle. But this does not behave predictably across all npm versions - see https://github.com/mapbox/node-pre-gyp/issues/260 for the details. So we do not recommend using `preinstall` to install `node-pre-gyp`. Instead we recommend bundling. More history on this at https://github.com/strongloop/fsevents/issues/157#issuecomment-265545908.\r\n\r\n##### The `binary` object has three required properties\r\n\r\n###### module_name\r\n\r\nThe name of your native node module. This value must:\r\n\r\n - Match the name passed to [the NODE_MODULE macro](http://nodejs.org/api/addons.html#addons_hello_world)\r\n - Must be a valid C variable name (e.g. it cannot contain `-`)\r\n - Should not include the `.node` extension.\r\n\r\n###### module_path\r\n\r\nThe location your native module is placed after a build. This should be an empty directory without other Javascript files. This entire directory will be packaged in the binary tarball. When installing from a remote package this directory will be overwritten with the contents of the tarball.\r\n\r\nNote: This property supports variables based on [Versioning](#versioning).\r\n\r\n###### host\r\n\r\nA url to the remote location where you've published tarball binaries (must be `https` not `http`).\r\n\r\nIt is highly recommended that you use Amazon S3. The reasons are:\r\n\r\n  - Various node-pre-gyp commands like `publish` and `info` only work with an S3 host.\r\n  - S3 is a very solid hosting platform for distributing large files.\r\n  - We provide detail documentation for using [S3 hosting](#s3-hosting) with node-pre-gyp.\r\n\r\nWhy then not require S3? Because while some applications using node-pre-gyp need to distribute binaries as large as 20-30 MB, others might have very small binaries and might wish to store them in a GitHub repo. This is not recommended, but if an author really wants to host in a non-s3 location then it should be possible.\r\n\r\nIt should also be mentioned that there is an optional and entirely separate npm module called [node-pre-gyp-github](https://github.com/bchr02/node-pre-gyp-github) which is intended to complement node-pre-gyp and be installed along with it. It provides the ability to store and publish your binaries within your repositories GitHub Releases if you would rather not use S3 directly. Installation and usage instructions can be found [here](https://github.com/bchr02/node-pre-gyp-github), but the basic premise is that instead of using the ```node-pre-gyp publish``` command you would use ```node-pre-gyp-github publish```.\r\n\r\n##### The `binary` object has two optional properties\r\n\r\n###### remote_path\r\n\r\nIt **is recommended** that you customize this property. This is an extra path to use for publishing and finding remote tarballs. The default value for `remote_path` is `\"\"` meaning that if you do not provide it then all packages will be published at the base of the `host`. It is recommended to provide a value like `./{name}/v{version}` to help organize remote packages in the case that you choose to publish multiple node addons to the same `host`.\r\n\r\nNote: This property supports variables based on [Versioning](#versioning).\r\n\r\n###### package_name\r\n\r\nIt is **not recommended** to override this property unless you are also overriding the `remote_path`. This is the versioned name of the remote tarball containing the binary `.node` module and any supporting files you've placed inside the `module_path` directory. Unless you specify `package_name` in your `package.json` then it defaults to `{module_name}-v{version}-{node_abi}-{platform}-{arch}.tar.gz` which allows your binary to work across node versions, platforms, and architectures. If you are using `remote_path` that is also versioned by `./{module_name}/v{version}` then you could remove these variables from the `package_name` and just use: `{node_abi}-{platform}-{arch}.tar.gz`. Then your remote tarball will be looked up at, for example, `https://example.com/your-module/v0.1.0/node-v11-linux-x64.tar.gz`.\r\n\r\nAvoiding the version of your module in the `package_name` and instead only embedding in a directory name can be useful when you want to make a quick tag of your module that does not change any C++ code. In this case you can just copy binaries to the new version behind the scenes like:\r\n\r\n```sh\r\naws s3 sync --acl public-read s3://mapbox-node-binary/sqlite3/v3.0.3/ s3://mapbox-node-binary/sqlite3/v3.0.4/\r\n```\r\n\r\nNote: This property supports variables based on [Versioning](#versioning).\r\n\r\n#### 2) Add a new target to binding.gyp\r\n\r\n`node-pre-gyp` calls out to `node-gyp` to compile the module and passes variables along like [module_name](#module_name) and [module_path](#module_path).\r\n\r\nA new target must be added to `binding.gyp` that moves the compiled `.node` module from `./build/Release/module_name.node` into the directory specified by `module_path`.\r\n\r\nAdd a target like this at the end of your `targets` list:\r\n\r\n```js\r\n    {\r\n      \"target_name\": \"action_after_build\",\r\n      \"type\": \"none\",\r\n      \"dependencies\": [ \"<(module_name)\" ],\r\n      \"copies\": [\r\n        {\r\n          \"files\": [ \"<(PRODUCT_DIR)/<(module_name).node\" ],\r\n          \"destination\": \"<(module_path)\"\r\n        }\r\n      ]\r\n    }\r\n```\r\n\r\nFor a full example see [node-addon-example's binding.gyp](https://github.com/springmeyer/node-addon-example/blob/2ff60a8ded7f042864ad21db00c3a5a06cf47075/binding.gyp).\r\n\r\n#### 3) Dynamically require your `.node`\r\n\r\nInside the main js file that requires your addon module you are likely currently doing:\r\n\r\n```js\r\nvar binding = require('../build/Release/binding.node');\r\n```\r\n\r\nor:\r\n\r\n```js\r\nvar bindings = require('./bindings')\r\n```\r\n\r\nChange those lines to:\r\n\r\n```js\r\nvar binary = require('node-pre-gyp');\r\nvar path = require('path');\r\nvar binding_path = binary.find(path.resolve(path.join(__dirname,'./package.json')));\r\nvar binding = require(binding_path);\r\n```\r\n\r\nFor a full example see [node-addon-example's index.js](https://github.com/springmeyer/node-addon-example/blob/2ff60a8ded7f042864ad21db00c3a5a06cf47075/index.js#L1-L4)\r\n\r\n#### 4) Build and package your app\r\n\r\nNow build your module from source:\r\n\r\n    npm install --build-from-source\r\n\r\nThe `--build-from-source` tells `node-pre-gyp` to not look for a remote package and instead dispatch to node-gyp to build.\r\n\r\nNow `node-pre-gyp` should now also be installed as a local dependency so the command line tool it offers can be found at `./node_modules/.bin/node-pre-gyp`.\r\n\r\n#### 5) Test\r\n\r\nNow `npm test` should work just as it did before.\r\n\r\n#### 6) Publish the tarball\r\n\r\nThen package your app:\r\n\r\n    ./node_modules/.bin/node-pre-gyp package\r\n\r\nOnce packaged, now you can publish:\r\n\r\n    ./node_modules/.bin/node-pre-gyp publish\r\n\r\nCurrently the `publish` command pushes your binary to S3. This requires:\r\n\r\n - You have installed `aws-sdk` with `npm install aws-sdk`\r\n - You have created a bucket already.\r\n - The `host` points to an S3 http or https endpoint.\r\n - You have configured node-pre-gyp to read your S3 credentials (see [S3 hosting](#s3-hosting) for details).\r\n\r\nYou can also host your binaries elsewhere. To do this requires:\r\n\r\n - You manually publish the binary created by the `package` command to an `https` endpoint\r\n - Ensure that the `host` value points to your custom `https` endpoint.\r\n\r\n#### 7) Automate builds\r\n\r\nNow you need to publish builds for all the platforms and node versions you wish to support. This is best automated.\r\n\r\n - See [Appveyor Automation](#appveyor-automation) for how to auto-publish builds on Windows.\r\n - See [Travis Automation](#travis-automation) for how to auto-publish builds on OS X and Linux.\r\n\r\n#### 8) You're done!\r\n\r\nNow publish your module to the npm registry. Users will now be able to install your module from a binary.\r\n\r\nWhat will happen is this:\r\n\r\n1. `npm install <your package>` will pull from the npm registry\r\n2. npm will run the `install` script which will call out to `node-pre-gyp`\r\n3. `node-pre-gyp` will fetch the binary `.node` module and unpack in the right place\r\n4. Assuming that all worked, you are done\r\n\r\nIf a a binary was not available for a given platform and `--fallback-to-build` was used then `node-gyp rebuild` will be called to try to source compile the module.\r\n\r\n## S3 Hosting\r\n\r\nYou can host wherever you choose but S3 is cheap, `node-pre-gyp publish` expects it, and S3 can be integrated well with [Travis.ci](http://travis-ci.org) to automate builds for OS X and Ubuntu, and with [Appveyor](http://appveyor.com) to automate builds for Windows. Here is an approach to do this:\r\n\r\nFirst, get setup locally and test the workflow:\r\n\r\n#### 1) Create an S3 bucket\r\n\r\nAnd have your **key** and **secret key** ready for writing to the bucket.\r\n\r\nIt is recommended to create a IAM user with a policy that only gives permissions to the specific bucket you plan to publish to. This can be done in the [IAM console](https://console.aws.amazon.com/iam/) by: 1) adding a new user, 2) choosing `Attach User Policy`, 3) Using the `Policy Generator`, 4) selecting `Amazon S3` for the service, 5) adding the actions: `DeleteObject`, `GetObject`, `GetObjectAcl`, `ListBucket`, `PutObject`, `PutObjectAcl`, 6) adding an ARN of `arn:aws:s3:::bucket/*` (replacing `bucket` with your bucket name), and finally 7) clicking `Add Statement` and saving the policy. It should generate a policy like:\r\n\r\n```js\r\n{\r\n  \"Version\": \"2012-10-17\",\r\n  \"Statement\": [\r\n    {\r\n      \"Sid\": \"Stmt1394587197000\",\r\n      \"Effect\": \"Allow\",\r\n      \"Action\": [\r\n        \"s3:DeleteObject\",\r\n        \"s3:GetObject\",\r\n        \"s3:GetObjectAcl\",\r\n        \"s3:ListBucket\",\r\n        \"s3:PutObject\",\r\n        \"s3:PutObjectAcl\"\r\n      ],\r\n      \"Resource\": [\r\n        \"arn:aws:s3:::node-pre-gyp-tests/*\"\r\n      ]\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n#### 2) Install node-pre-gyp\r\n\r\nEither install it globally:\r\n\r\n    npm install node-pre-gyp -g\r\n\r\nOr put the local version on your PATH\r\n\r\n    export PATH=`pwd`/node_modules/.bin/:$PATH\r\n\r\n#### 3) Configure AWS credentials\r\n\r\nThere are several ways to do this.\r\n\r\nYou can use any of the methods described at http://docs.aws.amazon.com/AWSJavaScriptSDK/guide/node-configuring.html.\r\n\r\nOr you can create a `~/.node_pre_gyprc`\r\n\r\nOr pass options in any way supported by [RC](https://github.com/dominictarr/rc#standards)\r\n\r\nA `~/.node_pre_gyprc` looks like:\r\n\r\n```js\r\n{\r\n    \"accessKeyId\": \"xxx\",\r\n    \"secretAccessKey\": \"xxx\"\r\n}\r\n```\r\n\r\nAnother way is to use your environment:\r\n\r\n    export node_pre_gyp_accessKeyId=xxx\r\n    export node_pre_gyp_secretAccessKey=xxx\r\n\r\nYou may also need to specify the `region` if it is not explicit in the `host` value you use. The `bucket` can also be specified but it is optional because `node-pre-gyp` will detect it from the `host` value.\r\n\r\n#### 4) Package and publish your build\r\n\r\nInstall the `aws-sdk`:\r\n\r\n    npm install aws-sdk\r\n\r\nThen publish:\r\n\r\n    node-pre-gyp package publish\r\n\r\nNote: if you hit an error like `Hostname/IP doesn't match certificate's altnames` it may mean that you need to provide the `region` option in your config.\r\n\r\n## Appveyor Automation\r\n\r\n[Appveyor](http://www.appveyor.com/) can build binaries and publish the results per commit and supports:\r\n\r\n - Windows Visual Studio 2013 and related compilers\r\n - Both 64 bit (x64) and 32 bit (x86) build configurations\r\n - Multiple Node.js versions\r\n\r\nFor an example of doing this see [node-sqlite3's appveyor.yml](https://github.com/mapbox/node-sqlite3/blob/master/appveyor.yml).\r\n\r\nBelow is a guide to getting set up:\r\n\r\n#### 1) Create a free Appveyor account\r\n\r\nGo to https://ci.appveyor.com/signup/free and sign in with your GitHub account.\r\n\r\n#### 2) Create a new project\r\n\r\nGo to https://ci.appveyor.com/projects/new and select the GitHub repo for your module\r\n\r\n#### 3) Add appveyor.yml and push it\r\n\r\nOnce you have committed an `appveyor.yml` ([appveyor.yml reference](http://www.appveyor.com/docs/appveyor-yml)) to your GitHub repo and pushed it AppVeyor should automatically start building your project.\r\n\r\n#### 4) Create secure variables\r\n\r\nEncrypt your S3 AWS keys by going to <https://ci.appveyor.com/tools/encrypt> and hitting the `encrypt` button.\r\n\r\nThen paste the result into your `appveyor.yml`\r\n\r\n```yml\r\nenvironment:\r\n  node_pre_gyp_accessKeyId:\r\n    secure: Dn9HKdLNYvDgPdQOzRq/DqZ/MPhjknRHB1o+/lVU8MA=\r\n  node_pre_gyp_secretAccessKey:\r\n    secure: W1rwNoSnOku1r+28gnoufO8UA8iWADmL1LiiwH9IOkIVhDTNGdGPJqAlLjNqwLnL\r\n```\r\n\r\nNOTE: keys are per account but not per repo (this is difference than Travis where keys are per repo but not related to the account used to encrypt them).\r\n\r\n#### 5) Hook up publishing\r\n\r\nJust put `node-pre-gyp package publish` in your `appveyor.yml` after `npm install`.\r\n\r\n#### 6) Publish when you want\r\n\r\nYou might wish to publish binaries only on a specific commit. To do this you could borrow from the [Travis CI idea of commit keywords](http://about.travis-ci.org/docs/user/how-to-skip-a-build/) and add special handling for commit messages with `[publish binary]`:\r\n\r\n    SET CM=%APPVEYOR_REPO_COMMIT_MESSAGE%\r\n    if not \"%CM%\" == \"%CM:[publish binary]=%\" node-pre-gyp --msvs_version=2013 publish\r\n\r\nIf your commit message contains special characters (e.g. `&`) this method might fail. An alternative is to use PowerShell, which gives you additional possibilities, like ignoring case by using `ToLower()`:\r\n\r\n    ps: if($env:APPVEYOR_REPO_COMMIT_MESSAGE.ToLower().Contains('[publish binary]')) { node-pre-gyp --msvs_version=2013 publish }\r\n\r\nRemember this publishing is not the same as `npm publish`. We're just talking about the binary module here and not your entire npm package.\r\n\r\n## Travis Automation\r\n\r\n[Travis](https://travis-ci.org/) can push to S3 after a successful build and supports both:\r\n\r\n - Ubuntu Precise and OS X (64 bit)\r\n - Multiple Node.js versions\r\n\r\nFor an example of doing this see [node-add-example's .travis.yml](https://github.com/springmeyer/node-addon-example/blob/2ff60a8ded7f042864ad21db00c3a5a06cf47075/.travis.yml).\r\n\r\nNote: if you need 32 bit binaries, this can be done from a 64 bit Travis machine. See [the node-sqlite3 scripts for an example of doing this](https://github.com/mapbox/node-sqlite3/blob/bae122aa6a2b8a45f6b717fab24e207740e32b5d/scripts/build_against_node.sh#L54-L74).\r\n\r\nBelow is a guide to getting set up:\r\n\r\n#### 1) Install the Travis gem\r\n\r\n    gem install travis\r\n\r\n#### 2) Create secure variables\r\n\r\nMake sure you run this command from within the directory of your module.\r\n\r\nUse `travis-encrypt` like:\r\n\r\n    travis encrypt node_pre_gyp_accessKeyId=${node_pre_gyp_accessKeyId}\r\n    travis encrypt node_pre_gyp_secretAccessKey=${node_pre_gyp_secretAccessKey}\r\n\r\nThen put those values in your `.travis.yml` like:\r\n\r\n```yaml\r\nenv:\r\n  global:\r\n    - secure: F+sEL/v56CzHqmCSSES4pEyC9NeQlkoR0Gs/ZuZxX1ytrj8SKtp3MKqBj7zhIclSdXBz4Ev966Da5ctmcTd410p0b240MV6BVOkLUtkjZJyErMBOkeb8n8yVfSoeMx8RiIhBmIvEn+rlQq+bSFis61/JkE9rxsjkGRZi14hHr4M=\r\n    - secure: o2nkUQIiABD139XS6L8pxq3XO5gch27hvm/gOdV+dzNKc/s2KomVPWcOyXNxtJGhtecAkABzaW8KHDDi5QL1kNEFx6BxFVMLO8rjFPsMVaBG9Ks6JiDQkkmrGNcnVdxI/6EKTLHTH5WLsz8+J7caDBzvKbEfTux5EamEhxIWgrI=\r\n```\r\n\r\nMore details on Travis encryption at http://about.travis-ci.org/docs/user/encryption-keys/.\r\n\r\n#### 3) Hook up publishing\r\n\r\nJust put `node-pre-gyp package publish` in your `.travis.yml` after `npm install`.\r\n\r\n##### OS X publishing\r\n\r\nIf you want binaries for OS X in addition to linux you can enable [multi-os for Travis](http://docs.travis-ci.com/user/multi-os/#Setting-.travis.yml)\r\n\r\nUse a configuration like:\r\n\r\n```yml\r\n\r\nlanguage: cpp\r\n\r\nos:\r\n- linux\r\n- osx\r\n\r\nenv:\r\n  matrix:\r\n    - NODE_VERSION=\"0.10\"\r\n    - NODE_VERSION=\"0.11.14\"\r\n\r\nbefore_install:\r\n- rm -rf ~/.nvm/ && git clone --depth 1 https://github.com/creationix/nvm.git ~/.nvm\r\n- source ~/.nvm/nvm.sh\r\n- nvm install $NODE_VERSION\r\n- nvm use $NODE_VERSION\r\n```\r\n\r\nSee [Travis OS X Gotchas](#travis-os-x-gotchas) for why we replace `language: node_js` and `node_js:` sections with `language: cpp` and a custom matrix.\r\n\r\nAlso create platform specific sections for any deps that need install. For example if you need libpng:\r\n\r\n```yml\r\n- if [ $(uname -s) == 'Linux' ]; then apt-get install libpng-dev; fi;\r\n- if [ $(uname -s) == 'Darwin' ]; then brew install libpng; fi;\r\n```\r\n\r\nFor detailed multi-OS examples see [node-mapnik](https://github.com/mapnik/node-mapnik/blob/master/.travis.yml) and [node-sqlite3](https://github.com/mapbox/node-sqlite3/blob/master/.travis.yml).\r\n\r\n##### Travis OS X Gotchas\r\n\r\nFirst, unlike the Travis Linux machines, the OS X machines do not put `node-pre-gyp` on PATH by default. To do so you will need to:\r\n\r\n```sh\r\nexport PATH=$(pwd)/node_modules/.bin:${PATH}\r\n```\r\n\r\nSecond, the OS X machines do not support using a matrix for installing different Node.js versions. So you need to bootstrap the installation of Node.js in a cross platform way.\r\n\r\nBy doing:\r\n\r\n```yml\r\nenv:\r\n  matrix:\r\n    - NODE_VERSION=\"0.10\"\r\n    - NODE_VERSION=\"0.11.14\"\r\n\r\nbefore_install:\r\n - rm -rf ~/.nvm/ && git clone --depth 1 https://github.com/creationix/nvm.git ~/.nvm\r\n - source ~/.nvm/nvm.sh\r\n - nvm install $NODE_VERSION\r\n - nvm use $NODE_VERSION\r\n```\r\n\r\nYou can easily recreate the previous behavior of this matrix:\r\n\r\n```yml\r\nnode_js:\r\n  - \"0.10\"\r\n  - \"0.11.14\"\r\n```\r\n\r\n#### 4) Publish when you want\r\n\r\nYou might wish to publish binaries only on a specific commit. To do this you could borrow from the [Travis CI idea of commit keywords](http://about.travis-ci.org/docs/user/how-to-skip-a-build/) and add special handling for commit messages with `[publish binary]`:\r\n\r\n    COMMIT_MESSAGE=$(git log --format=%B --no-merges -n 1 | tr -d '\\n')\r\n    if [[ ${COMMIT_MESSAGE} =~ \"[publish binary]\" ]]; then node-pre-gyp publish; fi;\r\n\r\nThen you can trigger new binaries to be built like:\r\n\r\n    git commit -a -m \"[publish binary]\"\r\n\r\nOr, if you don't have any changes to make simply run:\r\n\r\n    git commit --allow-empty -m \"[publish binary]\"\r\n\r\nWARNING: if you are working in a pull request and publishing binaries from there then you will want to avoid double publishing when Travis CI builds both the `push` and `pr`. You only want to run the publish on the `push` commit. See https://github.com/Project-OSRM/node-osrm/blob/8eb837abe2e2e30e595093d16e5354bc5c573575/scripts/is_pr_merge.sh which is called from https://github.com/Project-OSRM/node-osrm/blob/8eb837abe2e2e30e595093d16e5354bc5c573575/scripts/publish.sh for an example of how to do this.\r\n\r\nRemember this publishing is not the same as `npm publish`. We're just talking about the binary module here and not your entire npm package. To automate the publishing of your entire package to npm on Travis see http://about.travis-ci.org/docs/user/deployment/npm/\r\n\r\n# Versioning\r\n\r\nThe `binary` properties of `module_path`, `remote_path`, and `package_name` support variable substitution. The strings are evaluated by `node-pre-gyp` depending on your system and any custom build flags you passed.\r\n\r\n - `node_abi`: The node C++ `ABI` number. This value is available in Javascript as `process.versions.modules` as of [`>= v0.10.4 >= v0.11.7`](https://github.com/joyent/node/commit/ccabd4a6fa8a6eb79d29bc3bbe9fe2b6531c2d8e) and in C++ as the `NODE_MODULE_VERSION` define much earlier. For versions of Node before this was available we fallback to the V8 major and minor version.\r\n - `platform` matches node's `process.platform` like `linux`, `darwin`, and `win32` unless the user passed the `--target_platform` option to override.\r\n - `arch` matches node's `process.arch` like `x64` or `ia32` unless the user passes the `--target_arch` option to override.\r\n - `configuration` - Either 'Release' or 'Debug' depending on if `--debug` is passed during the build.\r\n - `module_name` - the `binary.module_name` attribute from `package.json`.\r\n - `version` - the semver `version` value for your module from `package.json` (NOTE: ignores the `semver.build` property).\r\n - `major`, `minor`, `patch`, and `prelease` match the individual semver values for your module's `version`\r\n - `build` - the sevmer `build` value. For example it would be `this.that` if your package.json `version` was `v1.0.0+this.that`\r\n - `prerelease` - the semver `prerelease` value. For example it would be `alpha.beta` if your package.json `version` was `v1.0.0-alpha.beta`\r\n\r\n\r\nThe options are visible in the code at <https://github.com/mapbox/node-pre-gyp/blob/612b7bca2604508d881e1187614870ba19a7f0c5/lib/util/versioning.js#L114-L127>\r\n\r\n# Download binary files from a mirror\r\n\r\nS3 is broken in China for the well known reason.\r\n\r\nUsing the `npm` config argument: `--{module_name}_binary_host_mirror` can download binary files through a mirror.\r\n\r\ne.g.: Install [v8-profiler](https://www.npmjs.com/package/v8-profiler) from `npm`.\r\n\r\n```bash\r\n$ npm install v8-profiler --profiler_binary_host_mirror=https://npm.taobao.org/mirrors/node-inspector/\r\n```\r\n",
  "readmeFilename": "README.md",
  "repository": {
    "type": "git",
    "url": "git://github.com/mapbox/node-pre-gyp.git"
  },
  "scripts": {
    "pretest": "retire -n && jshint test/build.test.js test/s3_setup.test.js test/versioning.test.js",
    "test": "jshint lib lib/util scripts bin/node-pre-gyp && mocha -R spec --timeout 500000",
    "update-crosswalk": "node scripts/abi_crosswalk.js"
  },
  "version": "0.6.36"
}
